<header>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
</header>
<div id="fondo">
  <div id="wrapper" class="container" *ngIf="getValor()">
    <div *ngIf="this.fav[0] == undefined" id="vacio">
      <div class="beta">
        <nav class="shelf">
          <a routerLink="/mostrarLibro" class="book home-page">Buscar libros</a>
          <a class="book about-us">Quiénes somos</a>
          <a class="book contact">Contáctanos</a>
          <a class="book faq">F.A.Q.</a>
          <span class="book not-found"></span>
          <span class="door left"></span>
          <span class="door right"></span>
        </nav>
        <h1>No se ha encontrado nada</h1>
        <p>Añade algún libro a favoritos</p>
      </div>
    </div>
    <div class="row misFavoritos" *ngIf="this.fav">
      <div class="col-lg-4 col-md-6 col-sm-12 favorito" *ngFor="let item of fav; let i = index">
        <div class="contenedor">
          <div class="foto">
            <img src="{{ item.photo }}" alt="" />
          </div>
          <div *ngIf="tienePeticion(item.book_id); else esFalse">
            <p>Peticion Creada</p>
            <p>Estado: {{tienePeticion(item.book_id)}}</p>
          </div>
          <ng-template #esFalse>
            <button class="v-btn" (click)="getBookUser(item.book_id)" (click)="openModal(petition)" class="boton">
              Pedir libro
            </button>
          </ng-template>
          <button class="boton2" type="button" (click)="delFav(item.favorites_id, i)">
            Eliminar favorito
          </button>
        </div>
      </div>
    </div>

    <!----------------------------------- Modal para pedir libro ----------------------------------->
    <ng-template #petition>
      <div class="modal-petition">
        <div class="modal-header">
          <h3 class="modal-title pull-left">Haz tu petición</h3>
          <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class="modal-body">
          <div *ngIf="userbook[0]; else esFalse">
            <h4>Selecciona el usuario del libro</h4>
            <select name="libro" #elegido>
              <option value="{{item.user_id}}" *ngFor="let item of userbook"><b>{{ item.nickname }}</b>
                ({{ item.place }})</option>
            </select>
            <button class="v-btn" (click)="modalRef.hide()" (click)="postPeticion(elegido.value)"
              (click)="openModal(promptPetition)">
              Aceptar
            </button>
          </div>
          <ng-template #esFalse>
            <h4>Ups! Ya tienes este libro</h4>
          </ng-template>
        </div>
      </div>
    </ng-template>

    <!----------------------------------- Modal para pedir libro ----------------------------------->
    <ng-template #promptPetition>
      <div class="modal-prompt-petition">
        <div class="modal-body">
          <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
          </button>
          <div class="success-checkmark">
            <div class="check-icon">
              <span class="icon-line line-tip"></span>
              <span class="icon-line line-long"></span>
              <div class="icon-circle"></div>
              <div class="icon-fix"></div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <h4>¡Petición realizada!</h4>
        </div>
      </div>
    </ng-template>